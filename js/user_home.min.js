var ws_port=document.getElementById("ws_port").value;function new_practice_game(){var e=document.getElementById("user").value;if(window.confirm("New practice game?")){let t=new XMLHttpRequest;t.open("GET","/new_practice_game?user="+e,!0),t.setRequestHeader("Content-Type","text/html"),t.onreadystatechange=function(){4===t.readyState&&200===t.status&&(document.location.href=t.responseURL)},t.send(null)}}function clicked_delete_game_btn(e){var t=document.getElementById("games_lst");let n=t.options[t.selectedIndex];var a=document.getElementById("user").value;if(t.selectedIndex>0){if(!window.confirm("Are you sure you want to delete this game? It cannot be undone!"))return;let e=new XMLHttpRequest;e.open("GET","/delete_game?game_name="+n.text+"&n="+a,!0),e.setRequestHeader("Content-Type","text/html"),e.onreadystatechange=function(){4===e.readyState&&200===e.status&&(t.remove(t.selectedIndex),document.location.href="/home_page?user="+a)},e.send(null)}}function clicked_games_btn(e){var t=document.getElementById("user").value,n=document.getElementById("games_lst");if(0==n.selectedIndex)return;let a=n.options[n.selectedIndex];if(a){let e=new XMLHttpRequest;e.open("GET","/load_game?game_name="+a.text+"&n="+t,!0),e.setRequestHeader("Content-Type","text/html"),e.onreadystatechange=function(){document.location.href=this.responseURL},e.send(null)}}function clicked_logout_btn(e){var t=document.getElementById("user").value;let n=new XMLHttpRequest;n.open("GET","/logout?user="+t,!0),n.setRequestHeader("Content-Type","text/html"),n.onreadystatechange=function(){4===n.readyState&&200===n.status&&(document.location.href="/?user="+t)},n.send(null)}function clicked_add_pickup_name_btn(e){var t=document.getElementById("user").value;let n=new XMLHttpRequest;n.open("GET","/add_pickup_name?user="+t,!0),n.setRequestHeader("Content-Type","text/html"),n.onreadystatechange=function(){4===n.readyState&&200===n.status&&(document.location.href="/home_page?user="+t)},n.send(null)}function clicked_play_pickup_btn(e){var t=document.getElementById("user").value,n=document.getElementById("pickup_lst");let a=n[n.selectedIndex].label;if(a==document.getElementById("user_display_name").value)return;let o=new XMLHttpRequest;o.open("GET","/play_pickup_game?vs="+a+"&n="+t,!0),o.setRequestHeader("Content-Type","text/html"),o.onreadystatechange=function(){document.getElementById("user").value;4===o.readyState&&200===o.status&&(document.location.href=o.response)},o.send(null)}function clicked_admin_btn(e){var t=document.getElementById("user").value;let n=new XMLHttpRequest;n.open("GET","/wh_admin?user="+t,!0),n.setRequestHeader("Content-Type","text/html"),n.onreadystatechange=function(){let e=document.getElementById("user").value;4===n.readyState&&200===n.status&&(document.location.href="/wh_admin?user="+e)},n.send(null)}function init(){let e=document.getElementById("practice_btn");e&&e.addEventListener("click",new_practice_game),e=document.getElementById("active_games_btn"),e&&e.addEventListener("click",clicked_active_games_btn),e=document.getElementById("games_btn"),e&&e.addEventListener("click",clicked_games_btn),e=document.getElementById("delete_game_btn"),e&&e.addEventListener("click",clicked_delete_game_btn),e=document.getElementById("logout_btn"),e&&e.addEventListener("click",clicked_logout_btn),e=document.getElementById("add_pickup_btn"),e&&e.addEventListener("click",clicked_add_pickup_name_btn),e=document.getElementById("play_pickup_btn"),e&&e.addEventListener("click",clicked_play_pickup_btn),e=document.getElementById("admin_btn"),e&&e.addEventListener("click",clicked_admin_btn)}let un=document.getElementById("user_display_name"),user_name=un.value;const ws=new WebSocket("ws://dbc-games.com:"+ws_port);ws.onmessage=function(e){let t=JSON.parse(e.data),n=t.shift(),a=t.shift();if("message"==n.type)alert(a.data);else if("gamelist_add"==n.type){var o=document.getElementById("games_lst");(d=document.createElement("option")).text=a.data,o.options.add(d)}else if("gamelist_remove"==n.type){o=document.getElementById("games_lst");let e=-1;for(i=0;i<o.options.length;i++)o.options[i].label==a.data&&(e=i);-1!=e&&o.remove(e)}else if("pickuplist_add"==n.type){var d,l=document.getElementById("pickup_lst");(d=document.createElement("option")).text=a.data,l.options.add(d);let e=l.options.length-1;document.getElementById("num_waiting").innerText=`(${e} Available)`}else if("pickuplist_remove"==n.type){l=document.getElementById("pickup_lst");var c=document.getElementById("user_display_name").value;let e=-1;for(i=0;i<l.options.length;i++)l.options[i].label==a.data.name&&(e=i);if(-1!=e){l.remove(e);let t=l.options.length-1;document.getElementById("num_waiting").innerText=`(${t} Available)`}c==a.data.name&&alert(`${a.data.challenger} has accepted your challenge!`)}console.log("in socket: onmsg")},ws.onopen=function(){console.log("in socket: open")},ws.onerror=function(e){console.error("in socket: error "+e)},ws.onclose=function(e){console.log("in socket: close "+e)},init();